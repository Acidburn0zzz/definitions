<?xml version="1.0" encoding="UTF-8"?>
<?oxygen RNGSchema="http://www.oasis-open.org/docbook/xml/5.0/rng/docbook.rng" type="xml"?>
<!-- # $Id$ -->
<chapter 
    xmlns="http://docbook.org/ns/docbook" 
    xmlns:xlink="http://www.w3.org/1999/xlink"
    xmlns:xi="http://www.w3.org/2001/XInclude" 
    version="5.0" 
    xml:id="NeXusDefinitionLanguageChapter">
    <title>The NeXus Definition Language</title>

    <section>
        <title>Description of the NeXus Definition Language</title>
        <para>
			The intent of NXDL is to provide an easier, and
			rules-based method for defining a NeXus data file that is
			specific to either an instrument (where NeXus has been
			for years) or an area of scientific technique or analysis.
		</para>
        <para>NeXus wiki page: <link 
            xlink:href="http://www.nexusformat.org/NXDL"
            >NXDL</link><footnote><para><link
                xlink:href="http://www.nexusformat.org/NXDL"
                >http://www.nexusformat.org/NXDL</link
                ></para></footnote></para>
        <para>
            NXDL is the new NeXus definition language - 
            it will replace the  
            <link 
                xlink:href="http://www.nexusformat.org/Metaformat"
                >Meta-DTD format</link><footnote><para><link
                    xlink:href="http://www.nexusformat.org/Metaformat"
                    >http://www.nexusformat.org/Metaformat</link
                    ></para></footnote>
            as the way for specifying the content of NeXus data files. 
            NXDL is based on XML schema technology and follows on from 
            provisional work on NeXus schema <link 
                xlink:href="http://www.nexusformat.org/Schema"
                >NeXus schema</link><footnote><para><link
                    xlink:href="http://www.nexusformat.org/Schema"
                    >http://www.nexusformat.org/Schema</link
                    ></para></footnote>
            in Summer 2008.
        </para>
        <para>    
            At <link 
                xlink:href="http://www.nexusformat.org/images/b/b2/NIAC2008_minutes.pdf"
                >NIAC 2008</link>,<footnote><para><link
                    xlink:href="http://www.nexusformat.org/images/b/b2/NIAC2008_minutes.pdf"
                    >http://www.nexusformat.org/images/b/b2/NIAC2008_minutes.pdf</link
                    ></para></footnote>
            it was agreed that writing definitions directly 
            as schema would probably be too verbose and instead 
            a new language (NXDL) was devised that would then 
            be translated into XML schema for eventual validation. 
            The files written in the NXDL language are XML files 
            in their own right and have an associated XML schema - 
            this means a schema-aware XML editor can be used 
            and accurate definition creation is much easier 
            than it was with the old Meta-DTD.
        </para>
        <para>    
            For the latest NXDL definitions see the 
            <link 
                xlink:href="https://svn.nexusformat.org/definitions/trunk"
                >svn repository</link>.<footnote><para><link
                    xlink:href="https://svn.nexusformat.org/definitions/trunk"
                    >https://svn.nexusformat.org/definitions/trunk</link
                ></para></footnote>
        </para>
        <para>
			An NXDL description will be a true (not pseudo) XML file
			which structure can be validated by a schema.  See below
			for a draft example from the working repository.  Since
			the NXDL specification is not complete, expect that some
			aspects of this example might change.  NXDL is not intended
			to change the location of information stored in existing
			NeXus files, only to change (and simplify) the way the file
			would be arranged for a specific instance such as instrument or
			technique.
		</para>
        <para>
            There are several different elements used in the NXDL.
			These are:
            <glosslist>
                <glossentry>
                    <glossterm><literal>definition</literal></glossterm>
                    <glossdef><para>
                        Root element of an NXDL specification.
                        This is the basic definition of a new type.
                        Components must derive from an existing type 
                        and optionally provide documentation.
                    </para></glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>group</literal></glossterm>
                    <glossdef><para>
                        A group element refers to the definition of 
                        an existing NX object: either a base 
                        class (such as <literal>NXdata</literal>
                        or  <literal>NXgeometry</literal>), 
                        application definition, contributed definition,
                        or a locally-defined component.
                    </para></glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>field</literal></glossterm>
                    <glossdef><para>
                        A field declares a new element 
                        in the component being defined.
                    </para></glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>doc</literal></glossterm>
                    <glossdef><para>
                        Items can be documented (but this documentation is not
                        printed in the manual.  It only appears in the NXDL file.)
                    </para></glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>link</literal></glossterm>
                    <glossdef><para>
                        A link to another item.
                    </para></glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>attribute</literal></glossterm>
                    <glossdef><para>
                        attribute of <literal>field</literal>
                    </para></glossdef>
                </glossentry>
            </glosslist>
        </para>
        <note><para>Application definition is the minimum set of data necessary for data analysis software.</para></note>
        <simplesect>
            <title><literal>NXxrot.nxdl.xml</literal>: example NXDL specification</title>
            <programlisting language="xml" linenumbering="numbered"
                ><xi:include 
                    href="../applications/NXxrot.nxdl.xml" 
                    parse="text"/></programlisting>
        </simplesect>
        <simplesect>
            <title><literal>nxdl.xsd</literal> source code</title>
            <programlisting language="xml" linenumbering="numbered"
                ><xi:include 
                    href="../nxdl.xsd" 
                    parse="text"/></programlisting>
        </simplesect>
    </section>
</chapter>
