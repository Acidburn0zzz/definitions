<?xml version="1.0" encoding="UTF-8"?>
<?oxygen RNGSchema="http://www.oasis-open.org/docbook/xml/5.0/rng/docbook.rng" type="xml"?>
<!-- # $Id$ -->
<section 
    version="5.0"
    xml:id="NAPI-Examples" 
    xreflabel="Example NeXus programs using NAPI"
    xmlns="http://docbook.org/ns/docbook" 
    xmlns:xlink="http://www.w3.org/1999/xlink"
    xmlns:xi="http://www.w3.org/2001/XInclude">
        <title>Example NeXus programs using NAPI</title>
        <indexterm>
            <primary>NAPI</primary>
            <secondary>examples</secondary>
        </indexterm>
    
    <section xml:id="example.napi.simple.2d.write" 
        xreflabel="NAPI Simple 2-D Write Example (C, F77, F90)">
        <title>NAPI Simple 2-D Write Example (C, F77, F90)</title>
        <para>Code examples are provided in this section that write 2-D data 
            to a NeXus HDF5 file in C, F77, and F90 languages using the NAPI.</para>
        
        <para>
            The following code reads a two-dimensional set <code>counts</code>
            with dimension scales of <code>t</code> and <code>phi</code> using 
            local routines, and then writes a NeXus file containing a single 
            <code>NXentry</code> group and a single <code>NXdata</code> group. 
            This is the simplest data file that conforms to the NeXus standard. 
            The same code is provided in C, F77, and F90 versions.
            Compare these code examples with <xref linkend="native-HDF5-Examples"/>.
        </para>
        <example>
            <title>NAPI C Example: write simple NeXus file</title>
            <programlisting language="c" linenumbering="numbered"
                    ><xi:include href="examples/napi-example.c" parse="text"
                    /></programlisting>
        </example> 
        <example>
            <title>NAPI F77 Example: write simple NeXus file</title>
            <programlisting linenumbering="numbered"
                    ><xi:include href="examples/napi-example.f77" parse="text"
                    /></programlisting>
        </example> 
        <example>
            <title>NAPI F90 Example: write simple NeXus file</title>
            <programlisting linenumbering="numbered"
                    ><xi:include href="examples/napi-example.f90" parse="text"
                    /></programlisting>
        </example>
    </section>
    
    <section xml:id="example.napi.simple.3d.write.python" 
        xreflabel="NAPI Simple 3-D Write Example (Python)">
        <title>NAPI Simple 3-D Write Example (Python)</title>
        <para>A single code example is provided in this section that writes 3-D data 
            to a NeXus HDF5 file in the Python language using the NAPI.
            The data file may be retrieved from the repository of NeXus data 
            file examples: <link 
                xlink:href="http://svn.nexusformat.org/definitions/exampledata/simple3D.h5"><code
                    >http://svn.nexusformat.org/definitions/exampledata/simple3D.h5</code ></link>
        </para>
        <para>
            The data to be written to the file is a simple three-dimensional array (2 x 3 x 4) 
            of integers.  The single dataset is intended to demonstrate the order in 
            which each value of the array is stored in a NeXus HDF5 data file.
        </para>
        <example>
            <title>NAPI Python Example: write simple NeXus file</title>
            <programlisting language="python" linenumbering="numbered"
                    ><xi:include href="examples/simple3D.py" parse="text"
                    /></programlisting>
        </example>
        <para>
            For the purposes of an example, it is instructive to view the content of the 
            NeXus HDF5 file produced by the above program.  Since HDF5 is a binary file
            format, we cannot show the contents of the file directly in this manual.
            Instead, we first we view the content by showing the output from 
            the <code>h5dump</code> tool provided as part of the HDF5 tool kit:
            <code>h5dump simple3D.h5</code>
        </para>
        <example>
            <title>NAPI Python Example: <code>h5dump</code> output of NeXus HDF5 file</title>
            <programlisting linenumbering="numbered"
                    ><xi:include href="examples/simple3D.h5dump.txt" parse="text"
                    /></programlisting>
        </example>
        <para>
            The output of <code>h5dump</code> contains a lot of structural information 
            about the HDF5 file that can distract us from the actual content we added to the file.
            Next, we show the output from a custom Python tool (<code>h5toText.py</code>) 
            that we describe in a later section 
            (<xref linkend="h5py-example-h5toText"/>) 
            of this chapter.  This tool was developed to show the actual data content of an
            HDF5 file that we create.
        </para>
        <example>
            <title>NAPI Python Example: <code>h5toText</code> output of NeXus HDF5 file</title>
            <programlisting linenumbering="numbered"
                    ><xi:include href="examples/simple3D.xture.txt" parse="text"
                    /></programlisting>
        </example>
    </section>
</section>
