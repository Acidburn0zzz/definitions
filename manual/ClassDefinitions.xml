<?xml version="1.0" encoding="UTF-8"?>
<?oxygen RNGSchema="http://www.oasis-open.org/docbook/xml/5.0/rng/docbook.rng" type="xml"?>
<!-- # $Id$ -->
<appendix xml:id="ClassDefinitionsChapter" xmlns="http://docbook.org/ns/docbook" version="5.0"
    xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink">
    <title>NeXus classes</title>
    <section>
        <title>Overview of NeXus classes</title>
        <note>
            <para>This section intro could be rewritten in the breezy style of the NeXus wiki page:
                    <link xmlns:xlink="http://www.w3.org/1999/xlink"
                    xlink:href="http://www.nexusformat.org/Design"
                    >http://www.nexusformat.org/Design</link>
            </para>
        </note>
        <note>
            <para>
                Another suggestion is to move the Design section to this location.
            </para>
        </note>
        <para> Each of the NeXus classes is described in two basic ways. First, a short list of
            descriptive information is provided as a header, then a table summarizing the fields and
            groups that comprise the NeXus class is given. <variablelist>
                <varlistentry>
                    <term>SVN Id</term>
                    <listitem>
                        <para>Subversion repository checkout identification, stripped of the
                            surrounding dollar signs. (The <emphasis role="italic">Id</emphasis> is
                            blank on files copied direct from the repository that are not checked
                            out by a subversion client.)</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>NXDL source</term>
                    <listitem>
                        <para>Name of the NeXus class and a URL to the source listing in the NeXus
                            subversion repository.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>NeXus Definition Language</term>
                    <listitem>
                        <para>
                            The 
                            <link xlink:href="#NeXusDefinitionLanguageChapter"
                                >NeXus Definition Language (NXDL)</link>
                            (described in a separate chapter of this manual)
                            is used to describe the components in the NeXus
                            Base Classes, as well as application and contributed definitions.
                            The intent of NXDL is to provide a
                            rules-based method for defining a NeXus data file that is
                            specific to either an instrument (where NeXus has been
                            for years) or an area of scientific technique or analysis.
                            NXDL replaces the meta-DTD method used previously to
                            define the NeXus base classes.
                        </para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>extends class</term>
                    <listitem>
                        <para>NeXus class extended by this class. Most NeXus base classes only
                            extend the base class definition (NXDL).</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>other classes included</term>
                    <listitem>
                        <para>List (including URLs) of other classes used to define this
                            class.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>documentation</term>
                    <listitem>
                        <para>Description of the NeXus class. No markup or formatting is
                            allowed.</para>
                    </listitem>
                </varlistentry>
            </variablelist></para>
        <para>The table has columns to describe the basic information about each field or group in
            the class. An example of the varieties of specifications are given in the following
            table using items found in various NeXus base classes.</para>
        <table>
            <title>Example Tabular representation of a NeXus class</title>
            <tgroup cols="4">
                <colspec colwidth="1.5*"/>
                <colspec colwidth="1.5*"/>
                <colspec colwidth="1*"/>
                <colspec colwidth="3*"/>
                <thead>
                    <row>
                        <entry><?dblatex bgcolor="[gray]{0.8}"?>Name</entry>
                        <entry><?dblatex bgcolor="[gray]{0.8}"?>Type</entry>
                        <entry><?dblatex bgcolor="[gray]{0.8}"?>Units</entry>
                        <entry><?dblatex bgcolor="[gray]{0.8}"?>Description (and Occurences)</entry>
                    </row>
                </thead>
                <tbody>
                    <row rowsep="0">
                        <entry><literal>program_name</literal></entry>
                        <entry>NX_CHAR</entry>
                        <entry/>
                        <entry>
                            <para>Name of program used to generate this file</para>
                        </entry>
                    </row>
                    <row rowsep="0">
                        <entry><literal> @version</literal></entry>
                        <entry>NX_CHAR</entry>
                        <entry/>
                        <entry>
                            <para>Program version number</para>
                            <para> Occurences: 1 : <emphasis role="italic"> default
                                </emphasis></para>
                        </entry>
                    </row>
                    <row>
                        <entry><literal> @configuration</literal></entry>
                        <entry>NX_CHAR</entry>
                        <entry/>
                        <entry>
                            <para>configuration of the program</para>
                        </entry>
                    </row>
                    <row rowsep="0">
                        <entry><literal>thumbnail</literal></entry>
                        <entry>
                            <link xmlns:xlink="http://www.w3.org/1999/xlink"
                                xlink:href="http://www.nexusformat.org/NXnote">NXnote</link>
                        </entry>
                        <entry/>
                        <entry>
                            <para>A small image that is representative of the entry. An example of
                                this is a 640x480 JPEG image automatically produced by a low
                                resolution plot of the NXdata.</para>
                        </entry>
                    </row>
                    <row>
                        <entry><literal> @mime_type</literal></entry>
                        <entry>NX_CHAR</entry>
                        <entry/>
                        <entry>expected: <emphasis role="bold"
                            >mime_type="image/*"</emphasis></entry>
                    </row>
                    <row>
                        <entry/>
                        <entry>
                            <link xmlns:xlink="http://www.w3.org/1999/xlink"
                                xlink:href="http://www.nexusformat.org/NXgeometry">NXgeometry</link>
                        </entry>
                        <entry/>
                        <entry>describe the geometry of this class</entry>
                    </row>
                    <row>
                        <entry><literal>distance</literal></entry>
                        <entry>NX_FLOAT</entry>
                        <entry>NX_LENGTH</entry>
                        <entry>
                            <para>Distance from sample</para>
                        </entry>
                    </row>
                    <row>
                        <entry><literal>mode</literal></entry>
                        <entry>
                            <para>"Single Bunch" </para>
                            <para> | "Multi Bunch"</para>
                        </entry>
                        <entry/>
                        <entry>
                            <para>source operating mode</para>
                        </entry>
                    </row>
                    <row>
                        <entry><literal>target_material</literal></entry>
                        <entry>
                            <para>Ta</para>
                            <para> | W</para>
                            <para> | depleted_U</para>
                            <para> | enriched_U</para>
                            <para> | Hg</para>
                            <para> | Pb</para>
                            <para> | C</para>
                        </entry>
                        <entry/>
                        <entry>
                            <para>Pulsed source target material</para>
                        </entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
        <para> In the above example, the fields might appear in a NeXus XML data file as </para>
        <example>
            <title>Example fragment of a NeXus XML data file</title>
            <programlisting linenumbering="numbered" language="xml">
&lt;program_name version="1.0a" configuration="standard">
    MaxSAS
&lt;/program_name>
&lt;NXnote name="thumbnail" mime_type="image/*">
    &lt;!-- contents of an NXnote would appear here -->
&lt;/NXnote>
&lt;distance units="mm">125.6&lt;/distance>
&lt;mode> Single Bunch &lt;/mode>
&lt;target_material>depleted_U&lt;/target_material>
            </programlisting>
        </example>
        <para> The columns in the table are described as follows: </para>
        <para>
            <variablelist>
                <varlistentry>
                    <term>Name</term>
                    <listitem>
                        <para>Short name of the data field. Name must satisfy both HDF and XML
                            naming rules.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>Attributes</term>
                    <listitem>
                        <para>Additional metadata used to define this variable. Attributes are
                            identified with a leading "at" symbol (@) and belong with the preceding
                            field or group. In the example above, the
                                <literal>program_name</literal> element has two attributes:
                                <literal>version</literal> (required) and
                                <literal>configuration</literal> (optional) while the
                                <literal>thumbnail</literal> element has one attribute:
                                <literal>mime_type</literal> (optional).</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>Type</term>
                    <listitem>
                        <para>Type of data to be represented by this variable. The type is one of
                            those specified in the NeXus Definition Language. <warning>
                                <para> put the URL here </para>
                                <para> NXDL needs some documentation </para>
                            </warning></para>
                        <para>In the case where the variable can take only one value from a known
                            list, the list of known values is presented, such as: [ Beryllium |
                            "Pyrolytic Graphite" | Graphite | Sapphire | Silicon | Supermirror ].
                            Selections with included whitespace are surrounded by quotes. See the
                            example above for usage.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>Units</term>
                    <listitem>
                        <para>Type of engineering units to be used. The unit types are those allowed
                            by the NeXus Definition Language. <warning>
                                <para>THIS NEEDS REAL WORK HERE</para>
                            </warning></para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>Description</term>
                    <listitem>
                        <para>A simple text description of the data field. No markup or formatting
                            is allowed.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>Occurences</term>
                    <listitem>
                        <para>The absence of "Occurences" in the item description signifies that
                            both <literal>minOccurs</literal> and <literal>maxOccurs</literal> have
                            the default values.If the number of occurences of an item are specified
                            in the NXDL (through <literal>@minOccurs</literal> and
                                <literal>@maxOccurs</literal> attributes), they will be reported in
                            the Description column similar to the example shown above.</para>
                        <para> Default values for occurences are shown in the following table. The
                                <literal>NXDL element type</literal> is either a group (such as a
                            NeXus base class), a field (that specifies the name and type of a
                            variable), or an attribute of a field or group. The number of times an
                            item can appear ranges between <literal>minOccurs</literal> and
                                <literal>maxOccurs</literal>. A default <literal>minOccurs</literal>
                            of zero means the item is optional. For attributes,
                                <literal>maxOccurs</literal> cannot be greater than 1. </para>
                        <table>
                            <title>Default values for occurences</title>
                            <tgroup cols="3">
                                <thead>
                                    <row>
                                        <entry><?dblatex bgcolor="[gray]{0.8}"?>NXDL element type</entry>
                                        <entry><?dblatex bgcolor="[gray]{0.8}"?>minOccurs</entry>
                                        <entry><?dblatex bgcolor="[gray]{0.8}"?>maxOccurs</entry>
                                    </row>
                                </thead>
                                <tbody>
                                    <row>
                                        <entry>group</entry>
                                        <entry>0</entry>
                                        <entry>unbounded</entry>
                                    </row>
                                    <row>
                                        <entry>field</entry>
                                        <entry>0</entry>
                                        <entry>unbounded</entry>
                                    </row>
                                    <row>
                                        <entry>attribute</entry>
                                        <entry>0</entry>
                                        <entry>1</entry>
                                    </row>
                                </tbody>
                            </tgroup>
                        </table>
                    </listitem>
                </varlistentry>
            </variablelist>
        </para>
    </section>
	<!-- the next three sections are autogenerated by Makefile from NXDL files, do NOT edit them directly -->
    <xi:include href="BaseClassSections.xml"/>
    <xi:include href="ApplicationClassSections.xml"/>
    <xi:include href="ContributedClassSections.xml"/>
</appendix>
