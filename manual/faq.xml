<?xml version="1.0" encoding="UTF-8"?>
<?oxygen RNGSchema="http://www.oasis-open.org/docbook/xml/5.0/rng/docbook.rng" type="xml"?>
<!-- # $Id$ -->
<appendix xml:id="FAQSection" xmlns="http://docbook.org/ns/docbook" version="5.0"
    xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>Frequently Asked Questions</title>
    <indexterm significance="preferred">
        <primary>FAQ</primary>
    </indexterm>
    <para>This is a list of commonly asked questions concerning the NeXus data format.</para>
    <qandaset>
        <qandaentry>
            <question>
                <para>How many facilities use NeXus?</para>
            </question>
            <answer>
                <para>This is continually evolving. It has been used as the instrument format
                    for several years on some or all instruments at a number of facilities
                    including PSI (Switzerland), LLB (France), LANSCE (USA), and APS (USA). It
                    will be used on all future instrumentation at ISIS (UK), NIST (USA), and
                    ANSTO (Australia). Finally, it has been formally adopted by major facilities
                    under construction, the SNS (USA), JPARC (Japan) and Diamond Light Source
                    (UK).</para>
            </answer>
        </qandaentry>
        <qandaentry>
            <question>
                <para>NeXus files are only useful for archiving instrumental data, aren't
                    they?</para>
            </question>
            <answer>
                <para>NeXus files can be used to store both extremely simple data, e.g. a single
                    (x,y) array, and highly complex instrument descriptions. In fact, the
                    original intention of the NeXus data format was to provide a way of
                    interchanging data between facilities and their user communities. However,
                    the power of NeXus hierarchical design has led to its adoption as a standard
                    archiving format by several major facilities, such as ISIS, LANSCE, and the
                    SNS.</para>
            </answer>
        </qandaentry>
        <qandaentry>
            <question>
                <para>Why aren't <code>NXsample</code> and <code>NXmonitor</code> groups stored
                    in the <code>NXinstrument</code> group?</para>
            </question>
            <answer>
                <para>A NeXus file can contain a number of <code>NXentry</code> groups, which
                    may represent different scans in an experiment, or sample and calibration
                    runs, etc. In many cases, though by no means all, the instrument has the
                    same configuration so that it would be possible to save space by storing the
                        <code>NXinstrument</code> group once and using multiple links in the
                    remaining <code>NXentry</code> groups. It is assumed that the sample and
                    monitor information would be more likely to change from run to run, and so
                    should be stored at the top level.</para>
            </answer>
        </qandaentry>
        <qandaentry>
            <question>
                <para> How do I identify the plottable data? <indexterm>
                        <primary>plottable data</primary>
                    </indexterm>
                </para>
            </question>
            <answer>
                <para>Any program whose aim is to identify plottable data should use the
                    following procedure: <orderedlist>
                        <listitem>
                            <para>Open the first top level NeXus group with class
                                    <code>NXentry</code>.</para>
                        </listitem>
                        <listitem>
                            <para>Open the first NeXus group with class
                                <code>NXdata</code>.</para>
                        </listitem>
                        <listitem>
                            <para>
                                Loop through NeXus fields in this group searching for the
                                item with attribute <code>signal="1"</code> indicating
                                this field has the plottable data.
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                Check to see if this field has an attribute called <code>axes</code>.
                                If so, the names are defined as a comma-delimited string within
                                this attribute in the C-order of the data array, and you can
                                skip the next two steps.
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                If the <code>axes</code> attribute is not defined, search for the
                                one-dimensional NeXus fields with attribute 
                                <code>primary="1"</code>.
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                These are the dimension scales to label the axes of each
                                dimension of the data.
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                Link each dimension scale to the respective data dimension by
                                the <code>axis</code> attribute (<code>axis="1"</code>,
                                <code>axis="2"</code>, ... up to the rank of the data).
                            </para>
                        </listitem>
                        <listitem>
                            <para>If necessary, close the <code>NXdata</code> group, open the next one and
                                repeat steps 3 to 6.</para>
                        </listitem>
                        <listitem>
                            <para>If necessary, close the <code>NXentry</code> group, open the
                                next one and repeat steps 2 to 7. </para>
                        </listitem>
                    </orderedlist> Consult the <link 
                        xlink:href="#ApplicationProgramInterfaceSection">NeXus API</link>
                    section, which describes the routines available to program these operations.
                    In the course of time, generic NeXus browsers will provide this
                    functionality automatically. </para>
            </answer>
        </qandaentry>
        <qandaentry>
            <question>
                <para>Why are the NeXus classes so complicated? I'll never store all that
                    information</para>
            </question>
            <answer>
                <para>The NeXus classes are essentially glossaries of terms. If you need to
                    store a piece of information, consult the class definitions to see if it has
                    been defined. If so, use it. However, it is not compulsory to include every
                    item that has been defined if it is not relevant to your experiment. On the
                    other hand, if there is a NeXus definition for your instrument, you are
                    recommended to include all the compulsory items if you want to use standard
                    software to analyze your data.</para>
            </answer>
        </qandaentry>
        <qandaentry>
            <question>
                <para>I want to produce an application definition. How do I go about it?</para>
            </question>
            <answer>
                <para>Read the NXDL <indexterm>
                        <primary>NXDL</primary>
                </indexterm> Tutorial in <xref linkend="CreatingNxdlSpec"/>.</para>
                <para>If you encounter any problems because the classes are not sufficient to
                    describe your configuration, please contact the NIAC Executive Secretary
                    explaining the problem, and post a suggestion at the relevant class wiki
                    page. The NIAC <indexterm>
                        <primary>NIAC</primary>
                    </indexterm> is always willing to consider proposals to amend the base
                    classes. The procedures are defined in the NIAC constitution.<footnote>
                        <para>Refer to the most recent version of the NIAC constitution on the
                            NIAC wiki: <link xlink:href="http://www.nexusformat.org/NIAC"
                                    ><literal>http://www.nexusformat.org/NIAC</literal></link>
                        </para>
                    </footnote></para>
            </answer>
        </qandaentry>
        <qandaentry>
            <question>
                <para>Explain what is the purpose of <code>NXdata</code>.</para>
            </question>
            <answer>
                <para>
                    The information provided by the <code>NXdata</code> group, identification of
                    the default plottable data,
                    <indexterm>
                        <primary>NeXus basic motivation</primary>
                        <secondary>default plot</secondary>
                    </indexterm>
                    is one of the basic motivations (see
                    <xref linkend="SimplePlotting"/>) for the NeXus standard.
                    The choice of the name of the <code>NXdata</code> class is historic
                    so renaming it to something more descriptive of its actual function
                    would break legacy data files.
                    <code>NXdata</code> contains links to the plottable data stored elsewhere
                    in the <code>NXentry</code>.
                </para>
            </answer>
        </qandaentry>
        <qandaentry>
            <question>
                <para>Can I use a NXDL specification to parse a NeXus data file?</para>
            </question>
            <answer>
                <para>
                    This should be possible as there is nothing in the NeXus specifications
                    to prevent this but it is not implemented in NAPI.  You would need to
                    implement it for yourself.  You would be wise to consult the algorithms
                    in the Java version of <code>NXvalidate</code> (see <xref linkend="NXvalidate-java"/>) for
                    more details.
                </para>
            </answer>
        </qandaentry>
    </qandaset>
</appendix>
