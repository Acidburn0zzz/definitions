<?xml version="1.0" encoding="UTF-8"?>
<!--
# NeXus - Neutron and X-ray Common Data Format
# 
# Copyright (C) 2008 NeXus International Advisory Committee (NIAC)
# 
# This library is free software; you can redistribute it and/or
# modify it under the terms of the GNU Lesser General Public
# License as published by the Free Software Foundation; either
# version 2 of the License, or (at your option) any later version.
#
# This library is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public
# License along with this library; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
#
# For further information, see http://www.nexusformat.org

########### SVN repository information ###################
# $Date$
# $Author$
# $Revision$
# $HeadURL$
# $Id$
########### SVN repository information ###################
-->
<definition xmlns="http://definition.nexusformat.org/nxdl/3.1" category="base"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://definition.nexusformat.org/nxdl/3.1 ../nxdl.xsd"
    name="NXcrystal" 
    version="1.0"
    svnid="$Id$"
    type="group" extends="NXobject">

    <doc>Template of a crystal monochromator or analyzer. Permits double bent
        monochromator comprised of multiple segments with anisotropic 
        Gaussian mosaic.
        
        If curvatures are set to zero or are absent, array 
        is considered to be flat.
        
        Scattering vector is perpendicular to surface. Crystal is oriented
        parallel to beam incident on crystal before rotation, and lies in
        vertical plane.</doc>
    <group type="NXgeometry">
        <doc>Position of crystal</doc>
    </group>
    <field name="type">
        <doc>
            Material of monochromating substance.  
            Use the "reflection" field to indicate the (hkl) orientation.
            Use the "d_spacing" field to record the lattice plane spacing.
        </doc>
        <enumeration>
            <item value="PG"><doc>Highly Oriented Pyrolytic Graphite</doc></item>
            <item value="Ge"/>
            <item value="Si"/>
            <item value="Cu"/>
            <item value="Fe3Si"/>
            <item value="CoFe"/>
            <item value="Cu2MnAl"><doc>Heusler</doc></item>
            <item value="Multilayer"/>
            <item value="Diamond"/>
        </enumeration>
    </field>
    <field name="cut_angle" type="NX_FLOAT" units="NX_ANGLE">
        <doc>Cut angle of reflecting Bragg plane and plane of crystal surface</doc>
    </field>
    <field name="unit_cell" type="NX_FLOAT" units="NX_LENGTH">
        <doc>Unit cell parameters (lengths and angles)</doc>
        <dimensions size="2"><!--[n_comp,6]-->
            <dim index="1" value="n_comp"/>
            <dim index="2" value="6"/>
        </dimensions>
    </field>
    <field name="unit_cell_volume" type="NX_FLOAT" units="NX_VOLUME">
        <doc>Volume of the unit cell</doc>
    </field>
    <field name="orientation_matrix" type="NX_FLOAT">
        <doc>Orientation matrix of single crystal sample using Busing-Levy convention</doc>
        <dimensions size="2"><!--3,3-->
            <dim value="3"/>
            <dim value="3"/>
        </dimensions>
    </field>
    <field name="wavelength" type="NX_FLOAT" units="NX_WAVELENGTH">
        <doc>Optimum diffracted wavelength</doc>
        <dimensions><dim value="i"/></dimensions>
    </field>
    <field name="d_spacing" type="NX_FLOAT" units="NX_LENGTH">
        <doc>spacing between crystal planes of the reflection</doc>
    </field>
    <field name="scattering_vector" type="NX_FLOAT" units="NX_WAVENUMBER">
        <doc>Scattering vector, Q, of nominal reflection</doc>
    </field>
    <field name="reflection" type="NX_INT" units="NX_UNITLESS">
        <doc>Miller indices (hkl) values of nominal reflection</doc>
        <dimensions><dim value="3"/></dimensions>
    </field>
    <field name="segment_width" type="NX_FLOAT" units="NX_LENGTH">
        <doc>Horizontal width of individual segment</doc>
    </field>
    <field name="segment_height" type="NX_FLOAT" units="NX_LENGTH">
        <doc>Vertical height of individual segment</doc>
    </field>
    <field name="segment_thickness" type="NX_FLOAT" units="NX_LENGTH">
        <doc>Thickness of individual segment</doc>
    </field>
    <field name="segment_gap" type="NX_FLOAT" units="NX_LENGTH">
        <doc>Typical gap between adjacent segments</doc>
    </field>
    <field name="segment_columns" type="NX_FLOAT" units="NX_LENGTH">
        <doc>number of segment columns in horizontal direction</doc>
    </field>
    <field name="segment_rows" type="NX_FLOAT" units="NX_LENGTH">
        <doc>number of segment rows in vertical direction</doc>
    </field>
    <field name="mosaic_horizontal" type="NX_FLOAT" units="NX_ANGLE">
        <doc>horizontal mosaic Full Width Half Maximum</doc>
    </field>
    <field name="mosaic_vertical" type="NX_FLOAT" units="NX_ANGLE">
        <doc>vertical mosaic Full Width Half Maximum</doc>
    </field>
    <field name="curvature_horizontal" type="NX_FLOAT" units="NX_ANGLE">
        <doc>Horizontal curvature of focusing crystal</doc>
    </field>
    <field name="curvature_vertical" type="NX_FLOAT" units="NX_ANGLE">
        <doc>Vertical curvature of focusing crystal</doc>
    </field>
    <field name="polar_angle" type="NX_FLOAT" units="NX_ANGLE">
        <doc>Polar (scattering) angle at which crystal assembly is positioned.  
            Note: some instrument geometries call this term 2theta.</doc>
        <dimensions><dim ref="wavelength"/></dimensions>
    </field>
    <field name="azimuthal_angle" type="NX_FLOAT" units="NX_ANGLE">
        <doc>Azimuthal angle at which crystal assembly is positioned</doc>
        <dimensions><dim ref="wavelength"/></dimensions>
    </field>
    <field name="bragg_angle" type="NX_FLOAT" units="NX_ANGLE">
        <doc>Bragg angle of nominal reflection</doc>
        <dimensions><dim ref="wavelength"/></dimensions>
    </field>
    <field name="temperature" type="NX_FLOAT" units="NX_TEMPERATURE">
        <doc>average/nominal crystal temperature</doc>
    </field>
    <group type="NXlog" name="temperature_log">
        <doc>log file of crystal temperature</doc>
    </group>
    <group type="NXdata" name="reflectivity">
        <doc>crystal reflectivity versus wavelength</doc>
    </group>
    <group type="NXdata" name="transmission">
        <doc>crystal transmission versus wavelength</doc>
    </group>
</definition>
