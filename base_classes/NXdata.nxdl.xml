<?xml version="1.0" encoding="UTF-8"?>
<!--
# NeXus - Neutron and X-ray Common Data Format
# 
# Copyright (C) 2008-2010 NeXus International Advisory Committee (NIAC)
# 
# This library is free software; you can redistribute it and/or
# modify it under the terms of the GNU Lesser General Public
# License as published by the Free Software Foundation; either
# version 3 of the License, or (at your option) any later version.
#
# This library is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public
# License along with this library; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
#
# For further information, see http://www.nexusformat.org

########### SVN repository information ###################
# $Date$
# $Author$
# $Revision$
# $HeadURL$
# $Id$
########### SVN repository information ###################
-->
<definition xmlns="http://definition.nexusformat.org/nxdl/3.1" category="base"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://definition.nexusformat.org/nxdl/3.1 ../nxdl.xsd"
	name="NXdata" 
	version="1.0"
	type="group" 
	extends="NXobject"
	ignoreExtraItems="true"
	svnid="$Id$">
	
	<!-- 
		The ignoreExtraItems attribute is used in the definition to
		avoid warning messages that would be generated from unexpected groups/fields.
		Since common use of NXdata indicates field names of any value, _many_
		instances of this class would generate a warning message during validation
		without this attribute being set to "true".
	-->

	<doc>
		<para xmlns="http://docbook.org/ns/docbook">
			(required) <code>NXdata</code> is a template of plottable data and their dimension scales. 
			It is mandatory 
			that there is at least one group of this type in each NXentry group.  
			Note that the <code>variable</code> and <code>data</code> 
			can be defined with different names.  
			The <code>signal</code> and <code>axes</code> attribute of the 
			<code>data</code> item define which items 
			are plottable data and which are <emphasis>dimension scales</emphasis>.
			<indexterm>
				<primary>NeXus basic motivation</primary>
				<secondary>default plot</secondary>
			</indexterm>
			<itemizedlist>
				<listitem>
					<para>Each <code>NXdata</code> group will consist of only one data set
						containing plottable data and their standard deviations.</para>
				</listitem>
				<listitem>
					<para>This data set may be of arbitrary rank up to a maximum
						of <literal>NX_MAXRANK=32</literal>. </para>
				</listitem>
				<listitem>
					<para>
						The plottable data will be identified by the attribute:
						<code>signal="1"</code>
					</para>
				</listitem>
				<listitem>
					<para>
						The plottable data will identify the <emphasis>dimension 
							scale</emphasis>(s) in the <code>axes</code> attribute.
					</para>
				</listitem>
			</itemizedlist> 
			If available, the standard deviations of the data are to be
			stored in a data set of the same rank and dimensions, with the name <code>errors</code>. 
			<itemizedlist>
				<listitem>
					<para>For each data dimension, there should be a one-dimensional array
						of the same length. </para>
				</listitem>
				<listitem>
					<para>These one-dimensional arrays are the <emphasis>dimension scale</emphasis>s of the
						data,  <emphasis>i.e</emphasis>. the values of the independent variables at which the data
						is measured, such as scattering angle or energy transfer. </para>
				</listitem>
			</itemizedlist>
			There are two methods of linking 
			<indexterm>
				<primary>link</primary>
			</indexterm> 
			each data dimension to its respective dimension scale.
			
			The preferred (and recommended) method uses the <code>axes</code> 
			<indexterm>
				<primary>axes</primary>
			</indexterm> 
			attribute to specify the names of each <emphasis>dimension scale</emphasis>.
			
			The older method uses the <code>axis</code> attribute on each
			<emphasis>dimension scale</emphasis>
			to identify
			with an integer the axis whose value is the number of the dimension.
			
			<code>NXdata</code> is used to implement one of the basic motivations in NeXus,
			to provide a default plot for the data of this <code>NXentry</code>.  The actual data
			might be stored in another group and (hard) linked to the <code>NXdata</code> group.
		</para>
		
	</doc>
	<field name="variable" type="NX_NUMBER">
		<doc>
			<para xmlns="http://docbook.org/ns/docbook">
		 		Dimension scale defining an axis of the data.
		 		Client is responsible for defining the dimensions of the data.
			</para>
	 	</doc>
		<dimensions rank="1">
			<doc>
				<para xmlns="http://docbook.org/ns/docbook">
					A dimension scale must have a rank of 1 and has length "n".
				</para>
			</doc>
			<dim index="1" value="n"/>
		</dimensions>
		<attribute name="long_name"><doc>Axis label</doc></attribute>
		<attribute name="distribution" type="NX_BOOLEAN">
			<doc>
				<para xmlns="http://docbook.org/ns/docbook">
					<code>0|false</code>: single value, 
					<code>1|true</code>: multiple values
				</para>
			</doc>
		</attribute>
        <attribute name="first_good" type="NX_INT"><doc>Index of first good value</doc></attribute>
		<attribute name="last_good" type="NX_INT"><doc>Index of last good value</doc></attribute>
		<attribute name="axis" type="NX_POSINT">
			<doc>
				<para xmlns="http://docbook.org/ns/docbook">
					Index (positive integer) identifying this specific set of numbers.
					N.B. The <code>axis</code> attribute is the old way of designating a link.  
					Do not use the <code>axes</code> attribute with the <code>axis</code> attribute.
					The <code>axes</code> attribute is now preferred.
				</para>
			</doc>
		</attribute>
	</field>
	<field name="variable_errors" type="NX_NUMBER">
		<doc>
			<para xmlns="http://docbook.org/ns/docbook">
				Errors (uncertainties) associated with axis <code>variable</code>
				Client is responsible for defining the dimensions of the data.
			</para>
		</doc>
		<dimensions rank="1">
			<doc>
				<para xmlns="http://docbook.org/ns/docbook">
					A dimension scale must have a rank of 1 and has length "n", same as <code>variable</code>.
				</para>
			</doc>
			<dim index="1" value="n"/>
		</dimensions>
	</field>
	<field name="data" type="NX_NUMBER">
		<doc>
			<para xmlns="http://docbook.org/ns/docbook">
				Data values
				Client is responsible for defining the dimensions of the data.
			</para>
		</doc>
		<dimensions rank="dataRank">
			<doc>
				<para xmlns="http://docbook.org/ns/docbook">
					The rank (<code>dataRank</code>) of the <code>data</code> must satisfy
					<literal>1 &lt;= dataRank &lt;= NX_MAXRANK=32</literal>.  
					At least one <code>dim</code> must have length "n".
				</para>
			</doc>
			<dim value="n"/>
		</dimensions>
		<attribute name="signal" type="NX_INT">
			<doc>
				<para xmlns="http://docbook.org/ns/docbook">
					Plottable (independent) axis, indicate index number.
					Only one field in a <code>NXdata</code> group may have the 
					<code>signal="1"</code> attribute.
					Do not use the <code>signal</code> attribute with the <code>axis</code> attribute.
				</para>
			</doc>
		</attribute>
		<attribute name="axes">
			<doc>
				<para xmlns="http://docbook.org/ns/docbook">
					Defines the names of the dimension scales
					(independent axes) for this data set
					as a colon-delimited array.
					N.B. The <code>axes</code> attribute is the preferred 
					method of designating a link.  
					Do not use the <code>axes</code> attribute with the <code>axis</code> attribute.
				</para>
			</doc>
		</attribute>
		<attribute name="uncertainties">
			<doc>
				<para xmlns="http://docbook.org/ns/docbook">
					Specify the names of the errors (uncertainties) 
					of the dependent axes as plottable data.
					N.B. The <code>errors</code> attribute uses the same syntax
					as the <code>axes</code> attribute.
				</para>
			</doc>
		</attribute>
		<attribute name="long_name">
			<doc>data label</doc>
		</attribute>
	</field>
	<field name="errors" type="NX_NUMBER">
		<doc>
			<para xmlns="http://docbook.org/ns/docbook">
				Standard deviations of data values - 
				the data array is identified by the attribute <code>signal="1"</code>. 
				The <code>errors</code> array must have the same dimensions as <code>data</code>.
				Client is responsible for defining the dimensions of the data.
			</para>
		</doc>
		<dimensions rank="dataRank">
			<doc>
				<para xmlns="http://docbook.org/ns/docbook">
					The <code>errors</code> must have a the same rank (<code>dataRank</code>) 
					as the <code>data</code>.  
					At least one <code>dim</code> must have length "n".
				</para>
			</doc>
			<dim value="n"/>
		</dimensions>
	</field>
	<field name="scaling_factor" type="NX_FLOAT">
		<doc>
			<para xmlns="http://docbook.org/ns/docbook">
				The elements in data are usually float values really. For
				efficiency reasons these are usually stored as integers
				after scaling with a scale factor. This value is the scale
				factor. It is required to get the actual physical value,
				when necessary.
			</para>
		</doc>
	</field>
	<field name="offset" type="NX_FLOAT">
		<doc>
			<para xmlns="http://docbook.org/ns/docbook">
				An optional offset to apply to the values in data.
			</para>
		</doc>
	</field>
	<field name="x" type="NX_FLOAT" units="NX_ANY">
		<doc>
			This is an array holding the values to use for the x-axis of
			data.  The units must be appropriate for the measurement.
		</doc>
		<dimensions rank="1">
			<dim index="1" value="nx" />
		</dimensions>
	</field>
	<field name="y" type="NX_FLOAT" units="NX_ANY">
		<doc>
			This is an array holding the values to use for the y-axis of
			data.  The units must be appropriate for the measurement.
		</doc>
		<dimensions rank="1">
			<dim index="1" value="ny" />
		</dimensions>
	</field>
	<field name="z" type="NX_FLOAT" units="NX_ANY">
		<doc>
			This is an array holding the values to use for the z-axis of
			data.  The units must be appropriate for the measurement.
		</doc>
		<dimensions rank="1">
			<dim index="1" value="nz" />
		</dimensions>
	</field>
</definition>

