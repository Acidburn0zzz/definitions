<?xml version="1.0" ?>
<!--
URL: http://www.neutron.anl.gov/nexus/xml/NXmuontd.xml
Editor: Stephen Cottrell <S.P.Cottrell@rl.ac.uk>
$Id$

Instrument definition for time differential musr data file, used at ISIS.

-->
<NXroot file_name="{file name of original NeXus file}" file_time="{data and time of file creation}" file_update_time="{date and time of last file change at close}" nexus_version="{version of nexus API used in writing the file}" HDF_version="{version of HDF library used by nexus to create file}" HDF5_version="{version of HDF5 library used by nexus to create file}" creator="{facility or program where file originated}">

	<NXentry name="{name of entry}">
   	<IDF_version type="NX_INT32">{version of IDF that NeXus file confirms to}</IDF_version>
   	<title>{extended title for entry}</title>
   	<run_number type="NX_INT32">{run number}</run_number>
   	<start_time type="ISO8601">{start time and date of measurement}</start_time>
   	<end_time type="ISO8601">{end time and date of measurement}</end_time>
   	<duration type="NX_INT32" units="seconds">{duration of data collection}?</duration>
   	<experiment_identifier>{experiment number}</experiment_identifier>
   	<run_cycle>{accelerator cycle}?</run_cycle>
   	<definition version="{DTD version number}" URL="{URL of DTD}">{name of  DTD for writing entry}?</definition>
   	<program_name version="{version of creating program}" configuration="{configuration of software}">{Name of program used to generate this file}?</program_name>
   	<notes>{log of useful stuff about the experiment, supplied by the user}?</notes>
   	
   	<NXuser name="{name of user}">
   		<name role="{role of user} ?">{full name of user}</name>
   		<affiliation>{institute}?</affiliation>
   		<address>{address}?</address>
   		<telephone_number>{telephone number}?</telephone_number>
   		<fax_number>{fax number}?</fax_number>
   		<email>{email address}?</email>
   		<facility_user_id>{facility user number}?</facility_user_id>
     	</NXuser>
     	
     	<IXrun name="{name of run}">
     		<number_periods type="NX_INT32">{number of periods}</number_periods>
     		<raw_frames type="NX_INT32[np]" cycled="{'1' - cycled, otherwise '0'}">{raw frames collected for each period}</raw_frames>
     		<good_frames type="NX_INT32[np]" cycled="{'1' - cycled, otherwise '0'}">{good frames collected for each period}</good_frames>
     		<period_cycles type="NX_INT32[np]">{number of times data collection took place in each period}</period_cycles>
     		<period_labels>{comma separated list of period names}</period_labels>
     		<counts type="NX_FLOAT[np]" cycled="{'1' - cycled, otherwise '0'}">{counts collected for each period for all detectors}</counts>
     		<NXlog name="counts_log">?
     			<description>{description of log}?</description>
     			<displayname>{name displayed on DAE software}?</displayname>
     			<hardware>{rig}?</hardware>
     			<software>{version of driver used to collect data}?</software>
     			<value type="NX_INT32[:]" units="counts">{counts collected as a log of time}</value>
     			<time type="NX_FLOAT[:]" start="ISO8601" units="seconds">{times for logged counts}</time>
     		</NXlog>
     	</IXrun>
     	
     	<NXsample name="{name of sample}">
     		<name>{sample name}</name>
     		<notes>{sample notes}?</notes>
     		<size type="NX_FLOAT" units="mm" dimension="{dimension described by size: 'area' | 'diameter' | 'side'}">{sample size}?</size>
     		<thickness type="NX_FLOAT" units="mm">{sample thickness}?</thickness>
     		<mass type="NX_FLOAT" units="mg">{sample mass}?</mass>
     		<density type="NX_FLOAT" units="mg.cm-3">{sample density}?</density>
     		<sample_holder>{description of sample holder}?</sample_holder>
     		<flypast type="NX_INT32">{flypast collection used: "0" - No, "1" - Yes}?</flypast>
     		<temp_0 type="NX_FLOAT" units="K" hardware="{cryostat rig}" displayname="{name displayed on DAE software}" software="{version of driver used to collect data}">{temperature setting}*</temp_0>
     		<NXlog name="temp_0_log">*
     		   <description>{description of log}?</description>
     			<displayname>{name displayed on DAE software}?</displayname>
     			<hardware>{cryostat rig}?</hardware>
     			<software>{version of driver used to collect data}?</software>
     			<value type="NX_FLOAT[:]" units="K">{temperature as a log of time}</value>
     			<time type="NX_FLOAT[:]" start="ISO8601" units="seconds">{times for logged temperatures}</time>
     		</NXlog>
     		<bfield_0 type="NX_FLOAT" units="G" hardware="{magnet rig}" displayname="{name displayed on DAE software}" software="{version of driver used to collect data}" magnetic_field_state="{'TF' | 'LF'}" magnetic_field_vector="{cartesian vector describing field orientation}">{magnetic field setting}*</bfield_0>
     		<NXlog name="bfield_0_log">*
     		   <description>{description of log}?</description>
     			<displayname>{name displayed on DAE software}?</displayname>
     			<hardware>{magnet rig}?</hardware>
     			<software>{version of driver used to collect data}?</software>
     			<value type="NX_FLOAT[:]" units="G">{temperature as a log of time}</value>
     			<time type="NX_FLOAT[:]" start="ISO8601" units="seconds">{times for logged temperatures}</time>
     		</NXlog> 
     	</NXsample>
     	
     	<NXinstrument name="{name of instrument}">
     		<name>{instrument name}</name>
     		<NXsource name="{name of source}">
     			<name>{facility name}</name>
     			<beamline>{beamline name}</beamline>
     			<type>{type of beamline: "pulsed muon source" | "continuous muon source" | "low energy muon source"}</type>
     			<probe>"muons"</probe>
     			<frequency type="NX_FLOAT" units="Hz">{accelerator frequency}?</frequency>
     			<pulse_pattern type="NX_INT32[rep_len]" rep_len="{repitition length of pulse pattern}" period="{period of repetition of pulse pattern}" units="ms">{pulse pattern array: "1" pulse to target, "0" pulse missing}?</pulse_pattern>
     			<source_energy type="NX_FLOAT" units="MeV">{source energy at target}?</source_energy>
     			<current type="NX_FLOAT" units="uA">{source current}?</current>
     			<probe_energy type="NX_FLOAT" units="eV">{muon beam energy}?</probe_energy>
     			<target_material>{material used for muon production target}?</target_material>
     			<target_thickness type="NX_FLOAT" units="mm">{thickness of target}?</target_thickness>
     			<pulse_width type="NX_FLOAT" units="ns">{source pulse width}?</pulse_width>
     			<notes>{source related messages or announcements}?</notes>
     		</NXsource>
     		<NXdetector name="{name of detector bank}">
     			<description>{detector description}</description>
     			<orientation>{general detector arrangement: "Longitudinal" | "Transverse"}?</orientation>
     			<number type="NX_INT32">{number of detectors, 'nd'}</number>
     			<spectrum_index type="NX_INT32[ns]">{list of global specta}</spectrum_index>
     			<detector_index type="NX_INT32[ns]">{dectector_index[j] is the location of first detector in spectrum_index[j] in the array detector_list}?</detector_index>
     			<detector_count type="NX_INT32[ns]">{detector_count[j] is the total number of detectors forming spectrum in spectrum_index[j]}?</detector_count>
     			<detector_list type="NX_INT32[nd]">{sorted list of detector numbers}?</detector_list>
     			<crate type="NX_INT32[nd]">{crate number for detectors}?</crate>
     			<slot type="NX_INT32[nd]">{slot number for detectors}?</slot>
     			<input type="NX_INT32[nd]">{input number for detectors}?</input>
     			<NXtranslation name="positions">?
     				<distances type="NX_FLOAT[nd][2]" units="m">{(r,z) for detector positions}</distances>
     				<angles type="NX_FLOAT[nd]" units="degree">{theta for detector positions}</angles>
     			</NXtranslation>
     			<shape type="NX_CHAR[nd]">{shape of each detector: "cuboid" | "cylinder"}?</shape>
     			<size type="NX_FLOAT[nd][3]" units="mm">{detector size}?</size>
     			<solid_angle type="NX_FLOAT[nd]" units="steradians">{solid angle subtended by the detector at the sample}?</solid_angle>
     			<calibrated_angles type="NX_FLOAT[nd]" units="degree" calibration_date="{ISO8601 date of run}" calibration_run="{run number}">{calibrated detector angles}?</calibrated_angles>
     			<dead_time type="NX_FLOAT[ns]" units="us" calibration_date="{ISO8601 date of run}" calibration_run="{run number}">{array of detector deadtime values}?</dead_time>
     			<grouping type="NX_INT32[np][ns]" available="{'0' - not available, '1' - available}">{preferred spectrum grouping}?</grouping>
     			<alpha type="NX_FLOAT[ng][3]" available="{'0' - not available, '1' - available}">{alpha, for pairs of groups defined in grouping}?</alpha>
     		</NXdetector>
     		<NXaperture name="{name of aperture}">
     			<description>{description of aperture}</description>
     			<shape>{"rectangular" | "circular" | "horizontal slit" | "vertical slit"}</shape>
     			<material>{material from which aperture is fabricated}?</material>
     			<size type="NX_FLOAT[:]" units="mm">{dimensions of aperture}</size>
     		</NXaperture>
     	</NXinstrument>
     	
     	<NXdata name="{name of detector bank}">
     		<counts type="NX_INT32[np][ntc]" units="counts" signal="1" long_name="positron_counts" number="{number of histograms}">{array of counts}</counts>
     		<raw_time type="NX_FLOAT[ntc+1]" axis="1" primary="1" long_name="time" units="us">{time channel bin boundaries}</raw_time>
			<histogram_resolution type="NX_FLOAT" units="ns">{histogram resolution in this NXdata group}</histogram_resolution>
			<first_good_time type="NX_FLOAT[np][ns]" units="us">{time for first good data}</first_good_time>
			<last_good_time type="NX_FLOAT[np][ns]" units="us">{time for last good data}</last_good_time>
			<spectrum_index type="NX_INT32[ns]" axis="2" long_name="spectrum number" units="none">{spectrum number}</spectrum_index>
			<period type="NX_INT32[np]" axis="3" long_name="period number" units="none" labels="{comma separated list of period names}">{period number}</period>
 		</NXdata>
     	
     	<IXuif name="{name of user information file}">
     	<!--
     	Users can place additional information, outside the scope of the Instrument Definition, in this group
     	-->
     	</IXuif>
   	
   </NXentry>

</NXroot>
