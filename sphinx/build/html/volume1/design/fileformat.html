

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2.1.7.3.1.3. Physical File format &mdash; NeXus: User Guide and Reference Documentation v2011-09 documentation</title>
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2011-09',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="NeXus: User Guide and Reference Documentation v2011-09 documentation" href="../../index.html" />
    <link rel="up" title="2. NeXus Design" href="index.html" />
    <link rel="next" title="3. Frequently Asked Questions" href="../faq.html" />
    <link rel="prev" title="2.1.7.3.1.2. Rules for Storing Data Items in NeXus Files" href="datarules.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../faq.html" title="3. Frequently Asked Questions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="datarules.html" title="2.1.7.3.1.2. Rules for Storing Data Items in NeXus Files"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">NeXus: User Guide and Reference Documentation v2011-09 documentation</a> &raquo;</li>
          <li><a href="../../contents.html" >Contents</a> &raquo;</li>
          <li><a href="../index.html" >NeXus: User Manual</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">2. NeXus Design</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/nexuslogo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">2.1.7.3.1.3. Physical File format</a><ul>
<li><a class="reference internal" href="#choice-of-hdf-as-underlying-file-format">2.1.7.3.1.3.1. Choice of HDF as Underlying File Format</a></li>
<li><a class="reference internal" href="#mapping-nexus-into-hdf">2.1.7.3.1.3.2. Mapping NeXus into HDF</a></li>
<li><a class="reference internal" href="#mapping-nexus-into-xml">2.1.7.3.1.3.3. Mapping NeXus into XML</a></li>
<li><a class="reference internal" href="#special-attributes">2.1.7.3.1.3.4. Special Attributes</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="datarules.html"
                        title="previous chapter">2.1.7.3.1.2. Rules for Storing Data Items in NeXus Files</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../faq.html"
                        title="next chapter">3. Frequently Asked Questions</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/volume1/design/fileformat.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="physical-file-format">
<span id="fileformat"></span><h1>2.1.7.3.1.3. Physical File format<a class="headerlink" href="#physical-file-format" title="Permalink to this headline">¶</a></h1>
<span class="target" id="index-0"></span><p id="index-1">This section describes how NeXus structures are mapped to features of the
underlying physical file format.
This can also be considered a guide for people who wish to create NeXus
files without using the NeXus-API.</p>
<div class="section" id="choice-of-hdf-as-underlying-file-format">
<span id="fileformat-hdf-choice"></span><h2>2.1.7.3.1.3.1. Choice of HDF as Underlying File Format<a class="headerlink" href="#choice-of-hdf-as-underlying-file-format" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-2"></span><p id="index-3">At its beginnings, the founders of NeXus identified the Hierarchical Data
Format (HDF) <a class="footnote-reference" href="#id2" id="id1">[1]</a>, as a multi-platform data storage format with capacity
for conveying large data payloads and a substantial user community. HDF
(now HDF5) was provided with software to read and write data (this is the
application-programmer interface, or API) using a large number of
computing systems in common use for neutron and X-ray science. HDF is a
binary data file format that supports compression and structured data.</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>HDF: <a class="reference external" href="http://www.hdfgroup.org">http://www.hdfgroup.org</a>,
initially from the National Center for Supercomputing
Applications (NCSA) at the University of Illinois at
Urbana-Champaign (UIUC) and later spun off into its own group
called The HDF Group (THG).</td></tr>
</tbody>
</table>
</div>
<div class="section" id="mapping-nexus-into-hdf">
<span id="fileformat-mapping-hdf"></span><h2>2.1.7.3.1.3.2. Mapping NeXus into HDF<a class="headerlink" href="#mapping-nexus-into-hdf" title="Permalink to this headline">¶</a></h2>
<p id="index-4">NeXus data structures map directly to HDF structures.</p>
<dl class="docutils">
<dt>NeXus <em>groups</em></dt>
<dd>HDF4 <em>vgroups</em> or HDF5 <em>groups</em></dd>
<dt>NeXus data sets (or <em>fields</em>)</dt>
<dd>HDF4 <em>SDS (scientific data sets)</em> or HDF5 <em>datasets</em></dd>
<dt>Attributes</dt>
<dd>HDF group or dataset attributes.</dd>
</dl>
<p>The only special case is the NeXus class name.
HDF4 supports a group class
which is set with the <tt class="docutils literal"><span class="pre">Vsetclass()</span></tt> call
and read with <tt class="docutils literal"><span class="pre">VGetclass()</span></tt>.
HDF-5 has no group class. Thus the NeXus class
is stored as a group attribute with the name <tt class="docutils literal"><span class="pre">NX_class</span></tt>.</p>
<p>NeXus links directly map to the HDF linking mechanisms.</p>
</div>
<div class="section" id="mapping-nexus-into-xml">
<span id="fileformat-mapping-xml"></span><h2>2.1.7.3.1.3.3. Mapping NeXus into XML<a class="headerlink" href="#mapping-nexus-into-xml" title="Permalink to this headline">¶</a></h2>
<p id="index-5">This takes a bit more work than HDF.
At the root of NeXus XML file
is a XML element with the name <tt class="docutils literal"><span class="pre">NXroot</span></tt>.
Further XML attributes to
<tt class="docutils literal"><span class="pre">NXroot</span></tt> define the NeXus file level attributes.</p>
<p>NeXus groups are encoded into XML as elements with the name of the NeXus
class and an XML attribute <tt class="docutils literal"><span class="pre">name</span></tt> which defines the NeXus name of the
group. Further group attributes become XML attributes. An example of a
NeXus group element in XML:</p>
<div class="highlight-text"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre>&lt;NXentry name=&quot;entry&quot;&gt;
&lt;/NXentry&gt;
</pre></div>
</td></tr></table></div>
<p id="index-6">NeXus data sets are encoded as XML elements with the name of the data. An
attribute <tt class="docutils literal"><span class="pre">NAPItype</span></tt> defines the type and dimensions of the data. The
actual data is stored as <tt class="docutils literal"><span class="pre">PCDATA</span></tt> <a class="footnote-reference" href="#id4" id="id3">[2]</a> in the element. An example of two
NeXus data elements in XML:</p>
<div class="highlight-text"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre>&lt;mode NAPItype=&quot;NX_CHAR[7]&quot;&gt;
        monitor
&lt;/mode&gt;
&lt;counts NAPItype=&quot;NX_INT32[4]&quot;&gt;
        21 456  127876 319
&lt;/counts&gt;
</pre></div>
</td></tr></table></div>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td><tt class="docutils literal"><span class="pre">PCDATA</span></tt> is the XML term for
<em>parsed character data</em>
(see: <a class="reference external" href="http://www.w3schools.com/xml/xml_cdata.asp">http://www.w3schools.com/xml/xml_cdata.asp</a>)</td></tr>
</tbody>
</table>
<span class="target" id="index-7"></span><p id="index-8">Data are printed in appropriate formats and in C storage order.
The codes understood for <tt class="docutils literal"><span class="pre">NAPItype</span></tt> are
all the NeXus data type names. The dimensions
are given in square brackets as a comma
separated list. No dimensions need to be given if
the data is just a single value.
Data attributes are represented as XML attributes.
If the attribute is not a text string, then the
attribute is given in the form: <em>type:value</em>, for example:
<tt class="docutils literal"><span class="pre">signal=&quot;NX_INT32:1&quot;</span></tt>.</p>
<span class="target" id="index-9"></span><p id="index-10">NeXus links are stored in XML as XML elements with the name <tt class="docutils literal"><span class="pre">NAPIlink</span></tt>
and a XML attribute <tt class="docutils literal"><span class="pre">target</span></tt> which stores the path to the linked entity
in the file.  If the item is linked under a different name, then this name
is specified as a XML attribute name to the element <tt class="docutils literal"><span class="pre">NAPIlink</span></tt>.</p>
<p>The authors of the NeXus API worked with the author of the miniXML XML
<a class="footnote-reference" href="#minixml" id="id5">[3]</a> library to create a reasonably efficient way of handling
numeric data with XML. Using the NeXus API handling something like 400
detectors versus 2000 time channels in XML is not a problem. But you may
hit limits with XML as the file format when data becomes to large or you
try to process NeXus XML files with general XML tools. General XML tools
are normally ill-prepared to process large amounts of numbers.</p>
<table class="docutils footnote" frame="void" id="minixml" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[3]</a></td><td>MiniXML: <a class="reference external" href="http://www.minixml.org/">http://www.minixml.org/</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="special-attributes">
<span id="fileformat-specialattributes"></span><h2>2.1.7.3.1.3.4. Special Attributes<a class="headerlink" href="#special-attributes" title="Permalink to this headline">¶</a></h2>
<p id="index-11">NeXus makes use of some special attributes for its internal purposes.
These attributes are stored as normal group or data set attributes
in the respective file format. These are:</p>
<dl class="docutils" id="index-12">
<dt>target</dt>
<dd>The <cite>target</cite> attribute is automatically created when items get linked.
The target attribute contains a text string with
the path to the source of the item linked.</dd>
<dt><tt class="docutils literal"><span class="pre">napimount</span></tt></dt>
<dd>The <tt class="docutils literal"><span class="pre">napimount</span></tt> attribute is used to implement
external linking in NeXus.
The string is a URL to the file and group in the
external file to link too. The system is meant to be extended.
But as of now, the only format supported is:
<tt class="docutils literal"><span class="pre">nxfile://path-to-file#path-infile</span></tt>.
This is a NeXus file in the file system at path-to-file
and the group path-infile in that
NeXus file.</dd>
</dl>
<dl class="docutils" id="index-13">
<dt><tt class="docutils literal"><span class="pre">NAPIlink</span></tt></dt>
<dd>NeXus supports linking items in another group under another name.
This is only supported natively in HDF-5.
For HDF-4 and XML a crutch is needed.
This crutch is a special class name or attribute
<tt class="docutils literal"><span class="pre">NAPIlink</span></tt> combined with the
target attribute. For groups, <tt class="docutils literal"><span class="pre">NAPILink</span></tt>
is the group class, for data items a special attribute
with the name <tt class="docutils literal"><span class="pre">NAPIlink</span></tt>.</dd>
</dl>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../faq.html" title="3. Frequently Asked Questions"
             >next</a> |</li>
        <li class="right" >
          <a href="datarules.html" title="2.1.7.3.1.2. Rules for Storing Data Items in NeXus Files"
             >previous</a> |</li>
        <li><a href="../../index.html">NeXus: User Guide and Reference Documentation v2011-09 documentation</a> &raquo;</li>
          <li><a href="../../contents.html" >Contents</a> &raquo;</li>
          <li><a href="../index.html" >NeXus: User Manual</a> &raquo;</li>
          <li><a href="index.html" >2. NeXus Design</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, http://nexusformat.org.
      Last updated on Sep 25, 2011.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>